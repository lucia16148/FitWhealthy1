<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FitWhealthy - Profilo Utente</title>
  <link rel="stylesheet" href="../css/profilo.css">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer" />

</head>
<body>
<div id="header-container"></div>
<script>
  fetch('header.html')
          .then(res => res.text())
          .then(data => {
            document.getElementById('header-container').innerHTML = data;

            // Ora che il header è nel DOM, aggancio il listener al logout-link
            const logoutLink = document.getElementById('logout-link');
            if (logoutLink) {
              logoutLink.addEventListener('click', (event) => {
                event.preventDefault();
                Swal.fire({
                  title: 'Sei sicuro di voler uscire?',
                  text: 'La sessione verrà chiusa.',
                  icon: 'warning',
                  showCancelButton: true,
                  confirmButtonText: 'Sì, esci',
                  cancelButtonText: 'Annulla'
                }).then((result) => {
                  if (result.isConfirmed) {
                    sessionStorage.removeItem('loggedInUser');
                    Swal.fire({
                      icon: 'info',
                      title: 'Logout effettuato',
                      text: 'Sei stato disconnesso con successo.',
                      confirmButtonText: 'OK'
                    }).then(() => {
                      window.location.href = 'mainpage.html';
                    });
                  }
                });
              });
            }
          });

</script>

<main class="profile-container">
  <h1>Profilo</h1>

  <div class="profile-card">
    <div class="profile-info-section">
      <div class="avatar-section">
        <img id="profile-avatar" src="https://via.placeholder.com/150" alt="Avatar utente" class="profile-avatar">
        <input type="file" id="avatar-upload" accept="image/*" style="display: none;">
        <button id="change-avatar-button">Cambia Avatar</button>
      </div>

      <div class="user-details">
        <h2 id="user-name">Nome Cognome</h2>
        <div class="detail-group">
          <h3>Dettagli</h3>
          <p><strong>Peso:</strong> <span id="display-weight">-- kg</span> <input type="number" id="input-weight" style="display:none;"></p>
          <p><strong>Altezza:</strong> <span id="display-height">-- cm</span> <input type="number" id="input-height" style="display:none;"></p>
          <p><strong>Età:</strong> <span id="display-age">-- anni</span> <input type="number" id="input-age" style="display:none;"></p>
        </div>
        <div class="detail-group">
          <h3>Recapiti</h3>
          <p><strong>Mail:</strong> <span id="display-email">--</span> <input type="email" id="input-email" style="display:none;"></p>
          <p><strong>Tel:</strong> <span id="display-phone">--</span> <input type="tel" id="input-phone" style="display:none;"></p>
        </div>
        <button id="edit-profile-button" class="action-button">Modifica Profilo</button>
        <button id="save-profile-button" class="action-button" style="display:none;">Salva Modifiche</button>
      </div>
    </div>

    <div class="profile-recipes-section">
      <div class="exercises-section">
        <h2>Esercizi Seguiti</h2>
        <ul id="exercises-list">
          <li>Trazioni</li>
          <li>Croci manubri</li>
        </ul>
      </div>

      <div class="user-recipes">
        <h2>Le Tue Ricette Create</h2>
        <div id="created-recipes-grid" class="recipes-grid">
        </div>
        <h2>Le Tue Ricette Preferite</h2>
        <div id="liked-recipes-grid" class="recipes-grid">
        </div>
      </div>
    </div>
  </div>
</main>
<div id="footer-container"></div>
<script>
  fetch('footer.html')
          .then(response => response.text())
          .then(data => {
            document.getElementById('footer-container').innerHTML = data;
          });
</script>
<script>
  function loadLikedExercises() {
    const exerciseList = document.getElementById('exercises-list');
    const likedExercises = JSON.parse(localStorage.getItem('likedExercises')) || [];
    exerciseList.innerHTML = '';

    if (likedExercises.length === 0) {
      exerciseList.innerHTML = '<li>Nessun esercizio preferito</li>';
    } else {
      likedExercises.forEach(name => {
        const li = document.createElement('li');
        li.textContent = name;
        exerciseList.appendChild(li);
      });
    }
  }

  document.addEventListener('DOMContentLoaded', loadLikedExercises);
</script>


<script src="/javascript/login.js"></script>
<script src="/javascript/profilo.js"></script>
<script src="/javascript/like.js"></script>
<script src="/javascript/category.js"></script>
</body>
</html>